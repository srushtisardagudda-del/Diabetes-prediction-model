# -*- coding: utf-8 -*-
"""diabetes prediction model .ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1REziuiEZszRff-0e-tspWAcTGcYBAAd2

## Importing the Dependancies
"""

import numpy as np
import pandas as pd
from sklearn.preprocessing import StandardScaler
from sklearn.model_selection import train_test_split
from sklearn import svm
from sklearn.metrics import accuracy_score

"""# Data collection and Analysis

# PIMA Diabetes Dataset
"""

#loading the diabetes dataset to a pandas dataframe
dataset = pd.read_csv('/content/Diabetes.csv')
dataset.head()

#number of rows and columns in this dataset
dataset.shape

# getting the statistical measures of the data
dataset.describe()

dataset['Outcome'].value_counts

"""# 0-->Non diabetic
# 1-->Diabetic
"""

dataset.groupby('Outcome').mean()

#separating the data and labels
x = dataset.drop(columns = 'Outcome', axis=1)
y = dataset['Outcome']

print(x)

print(Y)

"""# Data Standardization"""

scaler = StandardScaler()

scaler.fit(x)

std_data = scaler.transform(x)

print(std_data)

x = std_data
y = dataset['Outcome']

print(x)
print(y)

x_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.2,stratify=y,random_state=2)

print(x.shape,x_train.shape,x_test.shape)

"""# Training the Model"""

model = svm.SVC(kernel='linear')

#training the support vector Mchine Classifier
model.fit(x_train,y_train)

"""# Model Evaluation

# Accuracy Score
"""

#accuracy score on the training data
pred = model.predict(x_train)
acc = accuracy_score(pred,y_train)

print('Accuracy score of the training data : ',acc)

#accuracy score on the training data
pred = model.predict(x_test)
acc = accuracy_score(pred,y_test)

print('Accuracy score of the test data : ',acc)

"""# Making a Predictive system"""

input = (5,166,72,19,175,25.8,0.5,35)

#changing the input_data to numpy array
input_np = np.asarray(input)

#reshape the array as we are predicting for one instance
input_reshaped = input_np.reshape(1,-1)

#standardize the input data
std_data = scaler.transform(input_reshaped)
print(std_data)

prediction = model.predict(std_data)
print(prediction)

if (prediction[0] == 0):
  print('The person is not diabetic')
else:
  print('The person is diabetic')

